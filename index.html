<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#111">
  <title>Geometry Dash Game</title>

  <!-- Manifest Inline -->
  <script type="application/json" id="manifest">
    {
      "short_name": "Geometry Dash",
      "name": "Geometry Dash-like Game",
      "icons": [
        {
          "src": "icon.png",
          "sizes": "192x192",
          "type": "image/png"
        }
      ],
      "start_url": "/index.html",
      "background_color": "#111",
      "theme_color": "#111",
      "display": "standalone",
      "orientation": "portrait"
    }
  </script>
  
  <style>
    body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background-color: #111;
    }
    canvas {
      display: block;
    }
    #fullscreenButton {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #333;
      color: #fff;
      padding: 10px 20px;
      border: none;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas"></canvas>
  <button id="fullscreenButton">Go Full Screen</button>

  <!-- Service Worker Registration Script -->
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/service-worker.js').then(function(registration) {
        console.log('Service Worker registered with scope:', registration.scope);
      }).catch(function(error) {
        console.log('Service Worker registration failed:', error);
      });
    }
  </script>

  <!-- Inline Game Script -->
  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const fullscreenButton = document.getElementById('fullscreenButton');

    // Set initial canvas size
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    // Load levels from JSON (inline)
    const levelData = {
      "levels": [
        {
          "id": 1,
          "name": "Spike Gauntlet",
          "description": "A series of narrow platforms with spikes scattered all around. Time your jumps precisely to avoid the spikes.",
          "music": "spike-gauntlet.mp3",
          "platforms": [
            { "x": 0, "y": canvas.height - 50, "width": 500, "height": 50 },
            { "x": 600, "y": canvas.height - 150, "width": 200, "height": 20 },
            { "x": 900, "y": canvas.height - 250, "width": 200, "height": 20 }
          ],
          "spikes": [
            { "x": 600, "y": canvas.height - 100, "width": 50, "height": 50 },
            { "x": 900, "y": canvas.height - 180, "width": 50, "height": 50 },
            { "x": 1200, "y": canvas.height - 280, "width": 50, "height": 50 }
          ],
          "background": "#111",
          "levelColor": "#FF5733"
        },
        {
          "id": 2,
          "name": "Bouncing Madness",
          "description": "A level filled with wall bouncing and tricky obstacles. You must bounce off walls to survive.",
          "music": "bouncing-madness.mp3",
          "platforms": [
            { "x": 0, "y": canvas.height - 50, "width": 500, "height": 50 },
            { "x": 400, "y": canvas.height - 150, "width": 200, "height": 20 }
          ],
          "spikes": [
            { "x": 600, "y": canvas.height - 100, "width": 50, "height": 50 },
            { "x": 1000, "y": canvas.height - 200, "width": 50, "height": 50 }
          ],
          "bouncingWalls": [
            { "x": 700, "y": 300, "width": 50, "height": 100, "speed": 2 },
            { "x": 1100, "y": 200, "width": 50, "height": 100, "speed": -2 }
          ],
          "background": "#222",
          "levelColor": "#33FF57"
        }
      ]
    };

    // Function to load a level dynamically
    function loadLevel(levelId) {
      const level = levelData.levels.find(level => level.id === levelId);
      if (!level) return;

      // Set the background color
      document.body.style.backgroundColor = level.background;

      // Draw platforms
      ctx.fillStyle = level.levelColor;
      level.platforms.forEach(platform => {
        ctx.fillRect(platform.x, platform.y, platform.width, platform.height);
      });

      // Draw spikes
      ctx.fillStyle = "red";
      level.spikes.forEach(spike => {
        ctx.fillRect(spike.x, spike.y, spike.width, spike.height);
      });

      // Draw bouncing walls
      ctx.fillStyle = "blue";
      level.bouncingWalls.forEach(wall => {
        ctx.fillRect(wall.x, wall.y, wall.width, wall.height);
      });
    }

    // Full-screen mode
    fullscreenButton.addEventListener("click", function() {
      if (canvas.requestFullscreen) {
        canvas.requestFullscreen();
      } else if (canvas.mozRequestFullScreen) { // Firefox
        canvas.mozRequestFullScreen();
      } else if (canvas.webkitRequestFullscreen) { // Chrome and Safari
        canvas.webkitRequestFullscreen();
      } else if (canvas.msRequestFullscreen) { // IE/Edge
        canvas.msRequestFullscreen();
      }
    });

    // Load level 1 as default
    loadLevel(1);
  </script>
</body>
</html>
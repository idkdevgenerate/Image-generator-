<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Email Authentication</title>
  <style>
    /* General Modal Style */
    #modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255, 0, 0, 0.8); /* Red overlay to indicate urgency */
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      pointer-events: auto;
    }
    .modal-content {
      background: white;
      padding: 30px;
      border-radius: 10px;
      width: 500px;
      text-align: center;
      font-family: Arial, sans-serif;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.4);
      color: #ff0000;
    }

    /* Urgent Message */
    #authAnimation { display: none; }
    #checkmark, #failmark { display: none; }
    #status {
      font-size: 18px;
      font-weight: bold;
      color: #ff0000;
    }

    button { 
      padding: 15px 25px; 
      background-color: #ff0000; 
      color: white; 
      border: none; 
      border-radius: 5px; 
      cursor: pointer; 
      font-size: 16px;
      margin: 15px;
    }
    button:hover { 
      background-color: #d10000; 
    }

    /* Disable close until finished */
    #closeButton { display: none; }
  </style>
</head>
<body>

<!-- Modal for Email Authentication -->
<div id="modal">
  <div class="modal-content">
    <h2>Important Information</h2>
    <p>We have found out you were trying to send an email to the developer.</p>
    <p>Please follow the authentication process to complete the request.</p>
    <button onclick="showConfirm()">Proceed</button>
  </div>
</div>

<!-- Authentication Animation and Status -->
<div id="authAnimation">
  <div id="status">Authenticating...</div>
  <p>Please do not close the page until authentication is complete.</p>
</div>

<!-- Success/Failure Indicators -->
<div id="checkmark">
  <svg> <!-- Success Checkmark Animation --> </svg>
  <p>Authentication successful!</p>
</div>

<div id="failmark">
  <svg> <!-- Failure Animation --> </svg>
  <p id="errorMessage">Authentication failed.</p>
  <p>Sorry for the inconvenience, we are now reporting this error to our team.</p>
  <button onclick="retryAuthentication()">Retry</button>
</div>

<!-- Close Button -->
<button id="closeButton" onclick="closeModal()">Close</button>

<script>
// Step 1: Show confirmation and initiate authentication process
function showConfirm() {
  document.getElementById("modal").style.display = "none"; // Hide the initial modal
  document.getElementById("authAnimation").style.display = "block"; // Show authentication animation
  disableClose(); // Disable close button until process is finished
  authenticateEmail(); // Start email authentication process
}

// Step 2: Authenticate the email request (simulate with a mock check)
function authenticateEmail() {
  // Show authenticating message
  document.getElementById("status").innerText = "Authenticating with email server...";

  // Simulate a mock email authentication
  setTimeout(() => {
    const success = Math.random() > 0.5; // Random success or failure for demo
    if (success) {
      showSuccess();
    } else {
      showFailure("Authentication failed. Please try again.");
    }
  }, 5000); // Simulate a 5-second authentication process
}

// Show success checkmark and close modal
function showSuccess() {
  document.getElementById("checkmark").style.display = "block";
  document.getElementById("status").innerText = "Authentication successful!";
  setTimeout(() => {
    closeModal(); // Close the modal automatically after success
  }, 2000); // Wait 2 seconds before closing the modal
}

// Show failure animation and error message
function showFailure(message) {
  document.getElementById("failmark").style.display = "block";
  document.getElementById("status").innerText = message;
  document.getElementById("errorMessage").innerText = message;
  enableClose(); // Enable close button after failure
}

// Retry authentication process
function retryAuthentication() {
  document.getElementById("failmark").style.display = "none"; // Hide failure indicator
  document.getElementById("authAnimation").style.display = "block"; // Show auth animation again
  authenticateEmail(); // Retry the authentication process
}

// Disable the close button during authentication
function disableClose() {
  document.getElementById("closeButton").style.display = "none";
  window.onbeforeunload = function() {
    return "You can't close this until the authentication process is finished.";
  };
}

// Enable the close button after process is complete
function enableClose() {
  document.getElementById("closeButton").style.display = "block";
  window.onbeforeunload = null; // Allow closing the window after process finishes
}

// Close the modal
function closeModal() {
  document.getElementById("modal").style.display = "none";
  window.onbeforeunload = null; // Allow closing the window after modal closes
}
</script>

</body>
</html>